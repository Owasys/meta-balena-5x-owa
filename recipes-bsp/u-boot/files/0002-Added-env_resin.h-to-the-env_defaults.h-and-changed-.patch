From 8f6196c2ebc4a39a98c87cadd6153607ce72cd50 Mon Sep 17 00:00:00 2001
From: Alvaro Guzman <alvaro.guzman@owasys.com>
Date: Tue, 9 Aug 2022 15:59:39 +0200
Subject: [PATCH 02/11] Added env_resin.h to the env_defaults.h and changed
 Image type to Image.gz at uboot env

---
 include/configs/imx8mp_owa5x.h | 4 +++-
 include/env_default.h          | 1 +
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/include/configs/imx8mp_owa5x.h b/include/configs/imx8mp_owa5x.h
index 83b49128..cc0c9ae3 100644
--- a/include/configs/imx8mp_owa5x.h
+++ b/include/configs/imx8mp_owa5x.h
@@ -199,6 +199,7 @@
 	"mmcroot=" CONFIG_MMCROOT " rootwait quiet rw mtdparts\0" \
 	"mmcautodetect=yes\0" \
 	"mmcargs=setenv bootargs ${jh_clk} console=${console} root=${mmcroot}\0 " \
+	"setenv bootargs ${resin_kernel_root} ${root_opt} ${os_cmdline};\0" \
 	"startmmcboot=echo Booting from mmc ...; " \
 		"run mmcargs; " \
 		"if test ${boot_fit} = yes || test ${boot_fit} = try; then " \
@@ -243,7 +244,8 @@
 	"loadbootscript=fatload mmc ${mmcdev}:${mmcpart} ${loadaddr} ${script};\0" \
 	"loadimage=fatload mmc ${mmcdev}:${mmcpart} ${loadaddr} ${image}\0" \
 	"loadfdt=fatload mmc ${mmcdev}:${mmcpart} ${fdt_addr} ${fdt_file}\0" \
-	"image=Image\0" \
+	"image=Image.gz\0" \
+	"zip_addr=0x70480000\0" \
 	"netargs=setenv bootargs ${jh_clk} console=${console} " \
 		"root=/dev/nfs " \
 		"ip=dhcp nfsroot=${serverip}:${nfsroot},v3,tcp\0" \
diff --git a/include/env_default.h b/include/env_default.h
index 56a8bae3..197abe29 100644
--- a/include/env_default.h
+++ b/include/env_default.h
@@ -8,6 +8,7 @@
  */
 
 #include <env_callback.h>
+#include <env_resin.h>
 
 #ifdef DEFAULT_ENV_INSTANCE_EMBEDDED
 env_t embedded_environment __UBOOT_ENV_SECTION__(environment) = {
-- 
2.25.1

